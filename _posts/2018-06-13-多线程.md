---
layout:     post
title:      多线程相关
subtitle:   乐观锁+悲观锁+CountDownLatch等等
date:       2018-06-13
author:     RX
header-img: img/post-bg-e2e-ux.jpg
catalog: true
tags:
    - 多线程
    - 乐观锁悲观锁
---

## 并发情况下 悲观锁 与乐观锁
###  首先介绍一些乐观锁与悲观锁:
　　悲观锁：总是假设最坏的情况，每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会阻塞直到它拿到锁。传统的关系型数据库里边就用到了很多这种锁机制，比如行锁，表锁等，读锁，写锁等，都是在做操作之前先上锁。再比如Java里面的同步原语synchronized关键字的实现也是悲观锁。

　　乐观锁：顾名思义，就是很乐观，每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号等机制。乐观锁适用于多读的应用类型，这样可以提高吞吐量，一般做法就是表增加一个字段"版本号"  每次更新的时候把查版本号+1  当别的线程同时更新时,比较版本号 如果不同 则不更新
  
